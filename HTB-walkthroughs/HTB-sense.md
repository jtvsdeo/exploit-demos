# HTB BOX Sense

## Enumeration
`nmap -sC -sV -A 10.10.10.60 -o nmap`
```
Starting Nmap 7.92 ( https://nmap.org ) at 2022-05-11 13:55 EDT
Nmap scan report for 10.10.10.60
Host is up (0.022s latency).
Not shown: 998 filtered tcp ports (no-response)
PORT    STATE SERVICE  VERSION
80/tcp  open  http     lighttpd 1.4.35
|_http-title: Did not follow redirect to https://10.10.10.60/
|_http-server-header: lighttpd/1.4.35
443/tcp open  ssl/http lighttpd 1.4.35
|_http-server-header: lighttpd/1.4.35
| ssl-cert: Subject: commonName=Common Name (eg, YOUR name)/organizationName=CompanyName/stateOrProvinceName=Somewhere/countryName=US
| Not valid before: 2017-10-14T19:21:35
|_Not valid after:  2023-04-06T19:21:35
|_ssl-date: TLS randomness does not represent time
|_http-title: Login


```
The http page redirects to https so gobuster willl scan the https website
The index page brings us to a pfsense login page.

Looks like it's going to be a web vulnerabillity. Time to fire up gobuster


`gobuster dir -u https://10.10.10.60 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -k -x php,txt`

Only interesting files so far are system-users.txt and changelog.txt

Here's the output for system-users.txt
``
username: Rohit
password: company defaults``

Default password for pfsense router is **pfsense**, so the creds ``rohit:pfsense`` give us login to the portal.

After logging in, it is evident that pfsense is running `2.1.3-RELEASE `

Searchsploit pfsense gives us 
```
pfSense < 2.1.4 - 'status_rrd_graph_img.php' Command Injection | php/webapps/43560.py

```

After modyfing the python exploit @/usr/share/exploitdb/exploits/php/webapps/43560.py for it to match out needs, we get root on the box







